# suppress inspection "SpringBootApplicationProperties" for whole file
# H2 Test Datasource
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=root
spring.datasource.password=password123
spring.sql.init.mode=always
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.h2.console.enabled=true
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
server.servlet.encoding.charset=UTF-8

# SQL scripts
sql.script.create.table.sensor=CREATE TABLE IF NOT EXISTS Sensor \
(id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,\
name VARCHAR(255) NOT NULL UNIQUE CHECK (LENGTH(name) >= 3 AND LENGTH(name) <= 30),\
created_at TIMESTAMP)


sql.script.create.table.measurement=CREATE TABLE IF NOT EXISTS Measurement \
(id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,\
temperature DOUBLE NOT NULL CHECK (temperature >= -100 AND temperature <= 100),\
raining BOOLEAN NOT NULL,\
measured_at TIMESTAMP,\
sensor_id INT REFERENCES Sensor(id) ON DELETE CASCADE)

sql.script.add.sensors=INSERT INTO Sensor (name, created_at) \
VALUES ('FirstSensor', CURRENT_TIMESTAMP),\
('SecondSensor', CURRENT_TIMESTAMP)

sql.script.add.measurements=INSERT INTO Measurement (temperature, raining, measured_at, sensor_id) \
VALUES (21.5, FALSE, CURRENT_TIMESTAMP, 1),\
(15.2, TRUE,  CURRENT_TIMESTAMP, 2)

sql.script.drop.table.measurement=DROP TABLE IF EXISTS Measurement
sql.script.drop.table.sensor=DROP TABLE IF EXISTS Sensor